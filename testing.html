<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="minimum-scale=1.0, width=device-width, maximum-scale=1.0, user-scalable=no"/>
<meta charset="utf-8">
<script src="https://unpkg.com/prop-types/prop-types.js"></script>
<script src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
<script src="https://unpkg.com/redux@3.7.2/dist/redux.min.js"></script>
<script src="https://unpkg.com/node-uuid@1.4.7/uuid.js"></script>
<title>Testing Area</title>
<style type='text/css'>
.hide {
	display: none 
}
</style>
</head>
<body>
<div id="react-container"></div>
<script type="text/babel">
const { Component } = React
const { render } = ReactDOM


/*/////////////////// App //////////////////*/
class App extends Component {	
	state = {
		"menu": [
			{
				"title": "Material", 
				"level": 0,
				"id": uuid.v4(),
				"parentItem":"Root",
				"childs": true,
				"show": true, 
			}, 
			{
				"title": "Spiritual", 
				"level": 0,
				"id": uuid.v4(),
				"parentItem":"Root",
				"childs": true,
				"show": true 				
			}, 
			{
				"title": "Career", 
				"level": -1,
				"id": uuid.v4(),
				"parentItem":"Material",
				"childs": true,
				"show": false,				 
			}, 
			{
				"title": "Private Life", 
				"level": -1,
				"id": uuid.v4(),
				"parentItem":"Material",	
				"childs": true,
				"show": false,				
			},
			{
				"title": "Education", 
				"level": -2,
				"id": uuid.v4(),
				"parentItem":"Career",	
				"childs": false,
				"show": false,				 
			}, 
			{
				"title": "Work", 
				"level": -2,
				"id": uuid.v4(),
				"parentItem":"Career",	
				"childs": false,
				"show": false,				 
			},
			{
				"title": "Creativity", 
				"level": -1,
				"id": uuid.v4(),
				"parentItem":"Spiritual",
				"childs": true,
				"show": false,				 
			}, 
			{
				"title": "Vlog", 
				"level": -2,
				"id": uuid.v4(),
				"parentItem":"Creativity",		
				"childs": false,
				"show": false,				 
			}, 		
		], 
	"notes": [
				{
					"message": "Here you can write your notes!",
					"id": uuid.v4(),						
				}
			],
	"techVars": 
				{
					"showNote": false, 
					"parentItem": null
					}		
	}
// Menu fns//
/*After a click Fn shows every Item that one level deeper and have a common parent and do have some childs */	
     
	onClick = (title, id, level, childs, parentItem) => {	
		let item
		let { menu, notes, techVars } = this.state			
		
		const checkShowing = (item, level) => (item.level >= level-1 && item.parentItem == title) ? {...item, "show": true} :
		{...item, "show": false} 	
		
		menu = menu.map( item => checkShowing(item, level) )
		
		const toggleShowNote = (techVars) => ({"showNote": true, "parentItem": title})
	   
		const checkChilds = () => (childs) ? null : techVars=toggleShowNote(techVars)	
		
		checkChilds()
	
 	this.setState({menu, techVars})	
	console.log(techVars)
	} 	
//Message fns//	
onRemove = id => {
		const notes = this.state.notes.filter(
		note => note.id !== id		
		)
	this.setState({notes})
	}	
	
	addNote = (text) => {
	const notes = [
					...this.state.notes,
					{
						message: text,
						id: uuid.v4(),
						parentItem: this.state.techVars.parentItem
					}
		]
	this.setState({notes})
	}
		
	render() {
		const {menu, notes, techVars} = this.state 
		console.log(notes)	
		let showNote 
		return <div className="app-container">
			<div className="show-result"> 					 
				<MenuItemList menu = {menu} 
				onClick={(title, id, level, childs, parentItem)=> this.onClick(title, id, level, childs, parentItem)}/>
			</div>	
			<div className="note-list" className={ (techVars.showNote) ? "show" : "hide" }> 
				<NoteList notes={notes} onRemove={id=>this.onRemove(id)}/>
				<AddNote onNewText={(text)=>this.addNote(text)}/>		
			</div>	
		</div>
	}
}



/////////////Fns that show Menu//////////////////////
const MenuItem = ({title, id, level, show, childs, parentItem, onClick=f=>f}) => <div className={(show) ? "show" : "hide"} onClick={()=> onClick(title, id, level, childs, parentItem)}>{title}</div>
const MenuItemList = ({menu=[], onClick=f=>f}) => <div className="menuItem">{menu.map( menuItem => 
	<MenuItem key={menuItem.id} {...menuItem} onClick={(title, id, level, childs, parentItem)=> onClick(title, id, level, childs, parentItem)}/>
)}
</div>

//////////////////Fns that show, add, remove Notes ///////////////////////
const AddNote = ({onNewText=f=>f}) => {
		let _message
		const submit = e => {
		e.preventDefault()
		onNewText(_message.value)
		_message.value = ''
		_message.focus()
	}
 return (
	<form onSubmit={submit}>
	<input ref={input => _message = input}
	type="text"
	placeholder="Enter your message here" required/>
	<button>ADD</button>
	</form>
 )
}

const Note = ({message, id, onRemove=f=>f}) => <div className="note">{message}
	<button onClick={()=>onRemove(id)}>X</button>
</div>

const NoteList = ({notes=[], onRemove=f=>f}) => <div> 
	{(notes.length === 0) ?
		<p>No Notes Listed. (Add a Note)</p> :
	notes.map(note =>
	<Note key={note.id} 
			{...note} 
			onRemove={id=>onRemove(id)}></Note>		
		)
 }
</div>
/////////////////Tech fns////////////////////
 

/*//////////////////////////Render/////////////////////////*/	
render(
<App/>,
document.getElementById('react-container')
) 
</script>
</body>
</html>		





	
 